<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aya Acess√≥rios - Eleg√¢ncia Exclusiva</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#A7ED00">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Aya Acess√≥rios">
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- CSS -->
    <link rel="stylesheet" href="loja-styles-premium.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- ===================================
     META TAGS PARA iOS/SAFARI
     =================================== -->

     <!-- √çcones Apple (OBRIGAT√ìRIO para iOS) -->
     <link rel="apple-touch-icon" sizes="180x180" href="./icon-192x192.png">
     <link rel="apple-touch-icon" sizes="152x152" href="./icon-192x192.png">
     <link rel="apple-touch-icon" sizes="144x144" href="./icon-144x144.png">
     <link rel="apple-touch-icon" sizes="120x120" href="./icon-192x192.png">
     <link rel="apple-touch-icon" sizes="114x114" href="./icon-192x192.png">
     <link rel="apple-touch-icon" sizes="76x76" href="./icon-96x96.png">
     <link rel="apple-touch-icon" sizes="72x72" href="./icon-72x72.png">
     <link rel="apple-touch-icon" sizes="60x60" href="./icon-72x72.png">
     <link rel="apple-touch-icon" sizes="57x57" href="./icon-72x72.png">
     <link rel="apple-touch-icon" href="./icon-192x192.png">

     <!-- Configura√ß√µes do Safari -->
     <meta name="apple-mobile-web-app-capable" content="yes">
     <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
     <meta name="apple-mobile-web-app-title" content="Aya Acess√≥rios">

     <!-- Splash Screen iOS (tela de carregamento) -->
     <link rel="apple-touch-startup-image" href="./icon-512x512.png">

     <!-- Desabilitar detec√ß√£o autom√°tica de telefone -->
     <meta name="format-detection" content="telephone=no">
    
    <style>
        /* ===================================
           SPLASH SCREEN
           =================================== */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #A7ED00, #8BC500);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            animation: fadeOutSplash 0.5s ease 1.8s forwards;
        }

        .splash-logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 80px;
            font-weight: 700;
            letter-spacing: 12px;
            color: white;
            margin-bottom: 16px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
            animation: pulseSplash 1.5s ease infinite;
        }

        .splash-tagline {
            font-family: 'Montserrat', sans-serif;
            font-size: 16px;
            letter-spacing: 4px;
            color: white;
            text-transform: uppercase;
            opacity: 0.95;
            margin-bottom: 40px;
        }

        .splash-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes pulseSplash {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes fadeOutSplash {
            to {
                opacity: 0;
                visibility: hidden;
                pointer-events: none;
            }
        }

        /* ===================================
           INSTALL PROMPT MODAL
           =================================== */
        .install-prompt-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 99998;
            padding: 20px;
            backdrop-filter: blur(10px);
            animation: fadeIn 0.3s ease;
        }

        .install-prompt-modal.show {
            display: flex;
        }

        .install-prompt-content {
            background: white;
            border-radius: 24px;
            padding: 40px 32px;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 24px 48px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.4s ease;
        }

        .install-prompt-icon {
            font-size: 72px;
            margin-bottom: 24px;
            animation: bounce 1s ease infinite;
        }

        .install-prompt-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 28px;
            font-weight: 700;
            color: #000;
            margin-bottom: 12px;
        }

        .install-prompt-text {
            font-size: 16px;
            color: #666;
            margin-bottom: 32px;
            line-height: 1.6;
        }

        .install-prompt-benefits {
            text-align: left;
            margin-bottom: 32px;
            background: #F5F5F5;
            padding: 20px;
            border-radius: 12px;
        }

        .install-prompt-benefits li {
            list-style: none;
            padding: 8px 0;
            font-size: 14px;
            color: #333;
        }

        .install-prompt-benefits li:before {
            content: "‚úì";
            color: #A7ED00;
            font-weight: bold;
            margin-right: 12px;
            font-size: 18px;
        }

        .install-prompt-buttons {
            display: flex;
            gap: 12px;
            flex-direction: column;
        }

        .install-prompt-btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Montserrat', sans-serif;
        }

        .install-prompt-btn-primary {
            background: #A7ED00;
            color: #000;
        }

        .install-prompt-btn-primary:hover {
            background: #8BC500;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(167, 237, 0, 0.3);
        }

        .install-prompt-btn-secondary {
            background: transparent;
            color: #666;
            border: 2px solid #E0E0E0;
        }

        .install-prompt-btn-secondary:hover {
            border-color: #A7ED00;
            color: #A7ED00;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                transform: translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* ===================================
           BOTTOM NAVIGATION (Mobile)
           =================================== */
        @media (max-width: 768px) {
            body {
                padding-bottom: 70px;
            }

            .bottom-nav {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                height: 65px;
                background: white;
                border-top: 1px solid #E0E0E0;
                display: flex;
                justify-content: space-around;
                align-items: center;
                z-index: 1000;
                box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.08);
            }

            .bottom-nav-item {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 4px;
                padding: 8px 16px;
                color: #666;
                transition: all 0.3s ease;
                text-decoration: none;
                font-size: 11px;
                font-weight: 600;
                position: relative;
            }

            .bottom-nav-item.active {
                color: #A7ED00;
            }

            .bottom-nav-item svg {
                width: 24px;
                height: 24px;
                stroke: currentColor;
            }

            .bottom-nav-badge {
                position: absolute;
                top: 4px;
                right: 8px;
                background: #A7ED00;
                color: #000;
                font-size: 10px;
                font-weight: 700;
                padding: 2px 6px;
                border-radius: 10px;
                min-width: 18px;
                text-align: center;
            }

            /* Ocultar elementos no mobile */
            .header-premium .top-bar-premium {
                display: none;
            }

            .main-nav-premium {
                display: none !important;
            }

            .whatsapp-float-premium {
                bottom: 85px !important;
            }
        }

        /* App-like scroll */
        html {
            overscroll-behavior: none;
        }

        body {
            overscroll-behavior-y: contain;
        }

        /* Touch feedback */
        * {
            -webkit-tap-highlight-color: rgba(167, 237, 0, 0.2);
        }

        /* Page transition */
        body {
            animation: pageSlideIn 0.3s ease;
        }

        @keyframes pageSlideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Active button effect */
        .btn-primary:active,
        .btn-secondary:active,
        .btn-hero-premium:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-logo">AYA</div>
        <div class="splash-tagline">Eleg√¢ncia Exclusiva</div>
        <div class="splash-spinner"></div>
    </div>

    <!-- Install Prompt Modal -->
    <div class="install-prompt-modal" id="installPromptModal">
        <div class="install-prompt-content">
            <div class="install-prompt-icon">üì≤</div>
            <h2 class="install-prompt-title">Instalar App Aya Acess√≥rios</h2>
            <p class="install-prompt-text">
                Tenha acesso r√°pido e uma experi√™ncia completa instalando nosso aplicativo!
            </p>
            <ul class="install-prompt-benefits">
                <li>Acesso instant√¢neo pela tela inicial</li>
                <li>Funciona sem internet (offline)</li>
                <li>Notifica√ß√µes de promo√ß√µes</li>
                <li>Experi√™ncia como app nativo</li>
            </ul>
            <div class="install-prompt-buttons">
                <button class="install-prompt-btn install-prompt-btn-primary" id="installAcceptBtn">
                    üì• Instalar Agora
                </button>
                <button class="install-prompt-btn install-prompt-btn-secondary" id="installDeclineBtn">
                    Agora N√£o
                </button>
            </div>
        </div>
    </div>

    <!-- Header Premium -->
    <header class="header-premium">
        <div class="top-bar-premium">
            <div class="container-premium">
                <div class="top-bar-content">
                    <p class="announcement">‚ú®Seu estilo merece pe√ßas que falem por voc√™</p>
                    <div class="top-actions">
                        <a href="#" id="headerInstagram" class="top-link" target="_blank">
                            <span>üì∑ Instagram</span>
                        </a>
                        <a href="#" id="headerWhatsapp" class="top-link">
                            <span>üí¨ WhatsApp</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="main-header-premium">
            <div class="container-premium">
                <div class="header-content-premium">
                    <button class="mobile-menu-btn" id="mobileMenuToggle" aria-label="Menu">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>

                    <div class="logo-premium">
                        <a href="/index.html">
                            <img src="" alt="Aya Acess√≥rios" id="logoImage" class="logo-img" style="display: none;">
                            <h1 class="logo-text-premium" id="logoText">AYA ACESS√ìRIOS</h1>
                        </a>
                    </div>

                    <nav class="main-nav-premium" id="mainNav">
                        <a href="/index.html" class="nav-link-premium active">In√≠cio</a>
                        <a href="produtos.html" class="nav-link-premium">Cole√ß√£o</a>
                        <a href="sobre.html" class="nav-link-premium">Nossa Hist√≥ria</a>
                        <a href="contato.html" class="nav-link-premium">Contato</a>
                    </nav>

                    <div class="header-actions">
                        <a href="carrinho.html" class="cart-btn-premium">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 2L7 5"/>
                                <path d="M17 2L19 5"/>
                                <rect x="2" y="5" width="20" height="14" rx="2"/>
                                <path d="M10 12L14 12"/>
                            </svg>
                            <span class="cart-count-premium" id="cartCount">0</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section Premium -->
    <section class="hero-premium" id="heroBanner">
        <div class="hero-overlay-premium">
            <div class="container-premium">
                <div class="hero-content-premium">
                    <span class="hero-label">COLE√á√ÉO EXCLUSIVA 2025</span>
                    <h1 class="hero-title-premium">Eleg√¢ncia que<br>Define Voc√™</h1>
                    <p class="hero-subtitle-premium">Acess√≥rios √∫nicos para momentos especiais</p>
                    <a href="produtos.html" class="btn-hero-premium">
                        <span>Explorar Cole√ß√£o</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
        <div class="scroll-indicator">
            <span>Role para descobrir</span>
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14M19 12l-7 7-7-7"/>
            </svg>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-premium">
        <div class="container-premium">
            <div class="features-grid">
                <div class="feature-item">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M20 7h-4V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v2H4a1 1 0 00-1 1v11a2 2 0 002 2h14a2 2 0 002-2V8a1 1 0 00-1-1zM10 5h4v2h-4V5z"/>
                    </svg>
                    <h3>Pe√ßas Exclusivas</h3>
                    <p>Cole√ß√µes limitadas e √∫nicas</p>
                </div>
                <div class="feature-item">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    </svg>
                    <h3>Qualidade Premium</h3>
                    <p>Materiais selecionados</p>
                </div>
                <div class="feature-item">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                        <line x1="1" y1="10" x2="23" y2="10"/>
                    </svg>
                    <h3>Compra Segura</h3>
                    <p>Prote√ß√£o total</p>
                </div>
                <div class="feature-item">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="9" cy="21" r="1"/>
                        <circle cx="20" cy="21" r="1"/>
                        <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"/>
                    </svg>
                    <h3>Entrega R√°pida</h3>
                    <p>Frete gr√°tis acima de R$ 499</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Promo√ß√µes Premium -->
    <section class="promotions-premium" id="promotionsSection" style="display: none;">
        <div class="container-premium">
            <div class="section-header-premium">
                <span class="section-label">OFERTAS ESPECIAIS</span>
                <h2 class="section-title-premium">Promo√ß√µes Exclusivas</h2>
            </div>
            <div class="promotions-slider" id="promotionsGrid"></div>
        </div>
    </section>

    <!-- Produtos em Destaque Premium -->
    <section class="products-premium">
        <div class="container-premium">
            <div class="section-header-premium">
                <span class="section-label">DESTAQUES</span>
                <h2 class="section-title-premium">Pe√ßas em Evid√™ncia</h2>
                <p class="section-description">Descubra nossa sele√ß√£o curada de acess√≥rios exclusivos</p>
            </div>
            <div class="products-grid-premium" id="featuredProducts">
                <div class="loading-elegant">
                    <div class="spinner-elegant"></div>
                    <p>Carregando cole√ß√£o...</p>
                </div>
            </div>
            <div class="section-cta">
                <a href="produtos.html" class="btn-secondary-premium">
                    Ver Toda Cole√ß√£o
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </a>
            </div>
        </div>
    </section>

    <!-- Collections Premium -->
    <section class="collections-premium" id="collectionsSection" style="display: none;">
        <div class="container-premium">
            <div class="section-header-premium">
                <span class="section-label">EXPLORE</span>
                <h2 class="section-title-premium">Nossas Cole√ß√µes</h2>
            </div>
            <div class="collections-grid-premium" id="collectionsGrid"></div>
        </div>
    </section>

    <!-- Newsletter -->
    <section class="newsletter-premium">
        <div class="container-premium">
            <div class="newsletter-content">
                <div class="newsletter-text">
                    <h2>Receba Novidades Exclusivas</h2>
                    <p>Cadastre-se e ganhe 10% de desconto na primeira compra</p>
                </div>
                <form class="newsletter-form" id="newsletterForm">
                    <input type="email" placeholder="Seu melhor e-mail" required>
                    <button type="submit" class="btn-newsletter">Cadastrar</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer Premium -->
    <footer class="footer-premium">
        <div class="container-premium">
            <div class="footer-grid-premium">
                <div class="footer-col">
                    <h3 class="footer-logo">AYA ACESS√ìRIOS</h3>
                    <p class="footer-description" id="footerAbout">Eleg√¢ncia e exclusividade em cada detalhe.</p>
                    <div class="social-links-premium">
                        <a href="#" id="footerInstagram" target="_blank" aria-label="Instagram">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069z"/>
                            </svg>
                        </a>
                        <a href="#" id="footerWhatsapp" target="_blank" aria-label="WhatsApp">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/>
                            </svg>
                        </a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4>Navega√ß√£o</h4>
                    <ul class="footer-links-premium">
                        <li><a href="/index.html">In√≠cio</a></li>
                        <li><a href="produtos.html">Cole√ß√£o</a></li>
                        <li><a href="sobre.html">Nossa Hist√≥ria</a></li>
                        <li><a href="contato.html">Contato</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Atendimento</h4>
                    <ul class="footer-contact-premium">
                        <li id="footerPhone">-</li>
                        <li id="footerEmail">-</li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Informa√ß√µes</h4>
                    <p class="footer-address" id="footerAddress">-</p>
                </div>
            </div>
            <div class="footer-bottom-premium">
                <p>&copy; 2025 Aya Acess√≥rios. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Bottom Navigation (Mobile Only) -->
    <nav class="bottom-nav">
        <a href="index.html" class="bottom-nav-item active">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
            </svg>
            <span>In√≠cio</span>
        </a>
        <a href="produtos.html" class="bottom-nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="9" cy="21" r="1"/>
                <circle cx="20" cy="21" r="1"/>
                <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"/>
            </svg>
            <span>Produtos</span>
        </a>
        <a href="carrinho.html" class="bottom-nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 2L7 5M17 2L19 5"/>
                <rect x="2" y="5" width="20" height="14" rx="2"/>
            </svg>
            <span>Carrinho</span>
            <span class="bottom-nav-badge" id="cartCountBottom"></span>
        </a>
        <a href="contato.html" class="bottom-nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/>
            </svg>
            <span>Contato</span>
        </a>
    </nav>

    <!-- WhatsApp Floating Button -->
    <a href="#" id="whatsappFloat" class="whatsapp-float-premium" target="_blank" aria-label="WhatsApp">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
        </svg>
    </a>

    <!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-messaging-compat.js"></script>

<!-- Configura√ß√£o e FCM -->
<script src="loja-config.js"></script>
<script src="fcm-register.js"></script>
    
        <script>
    // ===================================
    // DETECTAR APP INSTALADO
    // ===================================
    const isStandalone = window.matchMedia('(display-mode: standalone)').matches || 
                         window.navigator.standalone === true;
    
    let deferredPrompt = null;

    console.log('üì± App standalone?', isStandalone);

    // ===================================
    // LIMPAR FLAGS PROBLEM√ÅTICAS
    // ===================================
    if (!isStandalone) {
        // Se N√ÉO est√° instalado, limpar flag de "j√° mostrou"
        localStorage.removeItem('installPromptShown');
        console.log('üßπ Flags limpas');
    }

    // ===================================
    // CAPTURAR EVENTO beforeinstallprompt
    // ===================================
    window.addEventListener('beforeinstallprompt', (e) => {
        console.log('üì≤ beforeinstallprompt CAPTURADO!');
        e.preventDefault();
        deferredPrompt = e;
        
        // Mostrar IMEDIATAMENTE ap√≥s splash
        if (!isStandalone) {
            console.log('‚úÖ Mostrando modal instala√ß√£o em 2.5s...');
            setTimeout(() => {
                showInstallModal();
            }, 2500);
        }
    });

    // ===================================
    // MOSTRAR MODAL INSTALA√á√ÉO
    // ===================================
    function showInstallModal() {
        if (isStandalone) {
            console.log('‚è≠Ô∏è App j√° instalado, pulando');
            return;
        }

        const modal = document.getElementById('installPromptModal');
        if (!modal) {
            console.error('‚ùå Modal #installPromptModal n√£o encontrado no HTML!');
            return;
        }

        if (deferredPrompt) {
            console.log('üì≤ MOSTRANDO MODAL DE INSTALA√á√ÉO');
            modal.classList.add('show');
        } else {
            console.warn('‚ö†Ô∏è deferredPrompt n√£o existe. Mostrando mesmo assim...');
            modal.classList.add('show');
        }
    }

    // ===================================
    // FOR√áAR MOSTRAR INSTALA√á√ÉO (fallback se evento n√£o disparar)
    // ===================================
    window.addEventListener('load', () => {
        if (!isStandalone) {
            // Se ap√≥s 4 segundos o modal ainda n√£o apareceu, for√ßar
            setTimeout(() => {
                const modal = document.getElementById('installPromptModal');
                if (modal && !modal.classList.contains('show')) {
                    console.warn('‚ö†Ô∏è beforeinstallprompt N√ÉO disparou. For√ßando modal...');
                    modal.classList.add('show');
                }
            }, 4000);
        }
    });

    // ===================================
    // BOT√ÉO INSTALAR
    // ===================================
    document.addEventListener('DOMContentLoaded', () => {
        const btnInstall = document.getElementById('installAcceptBtn');
        const btnDecline = document.getElementById('installDeclineBtn');

        if (btnInstall) {
            btnInstall.addEventListener('click', async () => {
                const modal = document.getElementById('installPromptModal');
                modal.classList.remove('show');
                
                if (!deferredPrompt) {
                    console.warn('‚ö†Ô∏è deferredPrompt n√£o existe');
                    alert('‚ö†Ô∏è Instala√ß√£o n√£o dispon√≠vel automaticamente.\n\nPara instalar:\n\nChrome: Menu (‚ãÆ) ‚Üí Instalar app\niOS Safari: Compartilhar (‚¨ÜÔ∏è) ‚Üí Adicionar √† tela inicial');
                    
                    // Marcar como "tentou instalar" e pedir notifica√ß√£o
                    localStorage.setItem('install_attempted', 'true');
                    setTimeout(() => pedirNotificacao(), 1000);
                    return;
                }

                console.log('üì• Solicitando instala√ß√£o...');
                
                try {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    
                    console.log('üìä Resultado:', outcome);
                    
                    if (outcome === 'accepted') {
                        console.log('‚úÖ Instalado!');
                        alert('‚úÖ App instalado com sucesso!');
                        localStorage.setItem('app_installed', 'true');
                        
                        // Pedir notifica√ß√£o ap√≥s instalar
                        setTimeout(() => pedirNotificacao(), 2000);
                    } else {
                        console.log('‚ùå Recusado');
                        alert('‚ÑπÔ∏è Instala√ß√£o cancelada');
                    }
                } catch (error) {
                    console.error('Erro:', error);
                    alert('‚ùå Erro ao instalar');
                }
                
                deferredPrompt = null;
            });
        }

        if (btnDecline) {
            btnDecline.addEventListener('click', () => {
                const modal = document.getElementById('installPromptModal');
                modal.classList.remove('show');
                console.log('‚ùå Instala√ß√£o recusada');
                localStorage.setItem('install_declined', 'true');
            });
        }
    });

    // ===================================
    // PEDIR NOTIFICA√á√ÉO
    // ===================================
    function pedirNotificacao() {
        const jaRegistrou = localStorage.getItem('fcm_registered') === 'true';
        const jaRecusou = localStorage.getItem('fcm_refused') === 'true';
        
        if (jaRegistrou || jaRecusou) {
            console.log('‚è≠Ô∏è Notifica√ß√£o j√° resolvida');
            return;
        }

        if (!('Notification' in window)) {
            console.warn('‚ö†Ô∏è Notifica√ß√µes n√£o suportadas');
            return;
        }

        console.log('üîî Pedindo dados para notifica√ß√£o...');

        const nome = prompt('üìù Digite seu nome para receber promo√ß√µes exclusivas:');
        if (!nome || nome.trim() === '') {
            console.log('‚ùå Nome n√£o informado');
            localStorage.setItem('fcm_refused', 'true');
            return;
        }

        const email = prompt('üìß Digite seu email:');
        if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
            alert('‚ùå Email inv√°lido');
            localStorage.setItem('fcm_refused', 'true');
            return;
        }

        console.log('üîî Registrando FCM com:', nome, email);
        
        if (typeof window.registerFCMFromModal === 'function') {
            window.registerFCMFromModal(nome.trim(), email.trim())
                .then(() => {
                    alert('‚úÖ Notifica√ß√µes ativadas! Voc√™ receber√° ofertas exclusivas.');
                })
                .catch(err => {
                    console.error('Erro FCM:', err);
                    alert('‚ùå Erro ao ativar notifica√ß√µes');
                });
        } else {
            console.warn('‚ö†Ô∏è registerFCMFromModal n√£o dispon√≠vel');
        }
    }

    // ===================================
    // EVENTO APP INSTALADO
    // ===================================
    window.addEventListener('appinstalled', () => {
        console.log('‚úÖ App instalado via evento!');
        localStorage.setItem('app_installed', 'true');
        alert('‚úÖ App instalado! Voc√™ pode acess√°-lo pela tela inicial.');
        
        // Pedir notifica√ß√£o
        setTimeout(() => pedirNotificacao(), 1500);
    });

    // ===================================
    // SERVICE WORKER
    // ===================================
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('./service-worker.js')
                .then(reg => console.log('‚úÖ SW:', reg.scope))
                .catch(err => console.error('‚ùå SW:', err));
        });
    }

    // ===================================
    // SPLASH SCREEN
    // ===================================
    window.addEventListener('load', () => {
        setTimeout(() => {
            const splash = document.getElementById('splashScreen');
            if (splash) {
                splash.style.display = 'none';
                console.log('üé¨ Splash fechado');
            }
        }, 2000);
    });

    // ===================================
    // NEWSLETTER FOOTER
    // ===================================
    function setupNewsletterForm() {
        const form = document.getElementById('newsletterForm');
        if (!form) return;

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const emailInput = form.querySelector('input[type="email"]');
            const email = emailInput.value.trim();
            
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                alert('‚ùå E-mail inv√°lido');
                return;
            }
            
            try {
                if (typeof firebase === 'undefined') throw new Error('Firebase off');
                const db = firebase.firestore();
                
                const exists = await db.collection('newsletter').where('email', '==', email).limit(1).get();
                
                if (!exists.empty) {
                    alert('‚ÑπÔ∏è E-mail j√° cadastrado!');
                    form.reset();
                    return;
                }

                await db.collection('newsletter').add({
                    email: email,
                    subscribedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    source: 'footer'
                });
                
                alert('‚úÖ Cadastrado!');
                form.reset();
            } catch (error) {
                console.error('Erro:', error);
                alert('‚ùå Erro');
            }
        });
    }

    function updateCartCount() {
        try {
            const cart = typeof getCart === 'function' ? getCart() : [];
            const total = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            document.querySelectorAll('#cartCount, .cart-count-premium').forEach(el => {
                if (el) el.textContent = total;
            });

            const badge = document.getElementById('cartCountBottom');
            if (badge) {
                badge.style.display = total > 0 ? 'block' : 'none';
                if (total > 0) badge.textContent = total;
            }
        } catch (error) {}
    }

    function setupMobileMenu() {
        const toggle = document.getElementById('mobileMenuToggle');
        const nav = document.getElementById('mainNav');
        if (toggle && nav) {
            toggle.addEventListener('click', () => {
                nav.classList.toggle('active');
                toggle.classList.toggle('active');
            });
        }
    }

    document.addEventListener('DOMContentLoaded', async () => {
        console.log('üöÄ Inicializando...');
        console.log('üì± Standalone?', isStandalone);
        
        try {
            if (typeof loadStoreSettings === 'function') await loadStoreSettings();
            if (typeof loadFeaturedProducts === 'function') await loadFeaturedProducts();
            if (typeof loadActivePromotions === 'function') await loadActivePromotions();
            if (typeof loadCollections === 'function') await loadCollections();
        } catch (error) {
            console.error('Erro:', error);
        }
        
        setupMobileMenu();
        updateCartCount();
        setupNewsletterForm();
        
        console.log('‚úÖ App carregado!');
    });

    // ===================================
    // DEBUG
    // ===================================
    window.forceInstallModal = () => {
        const modal = document.getElementById('installPromptModal');
        if (modal) {
            modal.classList.add('show');
            console.log('‚úÖ Modal for√ßado!');
        } else {
            console.error('‚ùå Modal n√£o encontrado!');
        }
    };

    window.resetAll = () => {
        localStorage.clear();
        console.log('üîÑ Tudo limpo! Recarregando...');
        location.reload();
    };

    window.checkStatus = () => {
        console.log('üìä STATUS:', {
            standalone: isStandalone,
            deferredPrompt: !!deferredPrompt,
            localStorage: {
                installPromptShown: localStorage.getItem('installPromptShown'),
                app_installed: localStorage.getItem('app_installed'),
                fcm_registered: localStorage.getItem('fcm_registered')
            }
        });
    };
    
    console.log('üí° Comandos:');
    console.log('   forceInstallModal() - for√ßar modal');
    console.log('   checkStatus() - ver status');
    console.log('   resetAll() - limpar tudo');
    </script>
</body>
</html>


